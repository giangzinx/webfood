<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Lịch sử đơn hàng</title>
    <link
      rel="apple-touch-icon"
      sizes="180x180"
      href="../public/img/favicons/apple-touch-icon.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="32x32"
      href="../public/img/favicons/favicon-32x32.png  "
    />
    <link
      rel="icon"
      type="image/png"
      sizes="16x16"
      href="../public/img/favicons/favicon-16x16.png"
    />
    <link
      rel="shortcut icon"
      type="image/x-icon"
      href="../public/img/favicons/favicon.ico"
    />
    <link rel="manifest" href="../public/img/favicons/manifest.json" />
    <meta
      name="msapplication-TileImage"
      content="../public/img/favicons/mstile-150x150.png"
    />
    <link href="../public/css/theme.css" rel="stylesheet" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css"
    />
    <link href="../public/css/transaction.css" rel="stylesheet" />
  </head>
  <body>
    <main class="main" id="top">
      <nav
        class="navbar navbar-expand-lg navbar-light bg-light fixed-top"
        data-navbar-on-scroll="data-navbar-on-scroll"
      >
        <div class="container">
          <a class="navbar-brand d-inline-flex" href="/index"
            ><img
              class="d-inline-block"
              src="../public/img/gallery/logo.svg"
              alt="logo"
            /><span class="text-1000 fs-3 fw-bold ms-2 text-gradient"
              >Ship PTIT</span
            ></a
          >
          <button
            class="navbar-toggler"
            type="button"
            data-bs-toggle="collapse"
            data-bs-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent"
            aria-expanded="false"
            aria-label="Toggle navigation"
          >
            <span class="navbar-toggler-icon"> </span>
          </button>
          <div
            class="collapse navbar-collapse border-top border-lg-0 my-2 mt-lg-0"
            id="navbarSupportedContent"
          >
            <div class="mx-auto pt-5 pt-lg-0 d-block d-lg-none d-xl-block">
              <p class="mb-0 fw-bold text-lg-center">
                Deliver to:
                <i class="fas fa-map-marker-alt text-light mx-2"></i
                ><span class="fw-normal">Vị trí của bạn </span
                ><span>Km10, Nguyễn Trãi, Hà Đông</span>
              </p>
            </div>
            <form class="d-flex mt-4 mt-lg-0 ms-lg-auto ms-xl-0">
              <div class="input-group-icon pe-2">
                <i class="fas fa-search input-box-icon text-primary"></i>
                <input
                  class="form-control border-0 input-box bg-100"
                  type="search"
                  placeholder="Search Food"
                  aria-label="Search"
                />
              </div>
              <!-- Replace existing button with this dropdown -->
              <div class="dropdown">
                <button
                  type="button"
                  class="btn btn-white shadow-warning text-warning dropdown-toggle"
                  id="userDropdown"
                  data-bs-toggle="dropdown"
                  aria-expanded="false"
                >
                  <i class="fas fa-user me-2"></i><%= customer_name %>
                </button>
                <ul
                  class="dropdown-menu dropdown-menu-end"
                  aria-labelledby="userDropdown"
                >
                  <li>
                    <a class="dropdown-item" href="#">
                      <i class="fas fa-id-card me-2"></i>Thông tin cá nhân
                    </a>
                  </li>
                  <li>
                    <a class="dropdown-item" href="/transaction">
                      <i class="fas fa-history me-2"></i>Lịch sử giao dịch
                    </a>
                  </li>
                  <li><hr class="dropdown-divider" /></li>
                  <li>
                    <a
                      class="dropdown-item"
                      href="/index"
                      onclick="handleLogout()"
                    >
                      <i class="fas fa-sign-out-alt me-2"></i>Đăng xuất
                    </a>
                  </li>
                </ul>
              </div>
            </form>
          </div>
        </div>
      </nav>
      <!-- Update container section -->
      <div class="container" style="margin-top: 6rem">
        <div class="row justify-content-center">
          <div class="col-12">
            <!-- Add yellow background wrapper -->
            <div
              class="transaction-wrapper bg-warning bg-opacity-10 p-4 rounded-3"
            >
              <h2 class="text-center mb-4 text-light">Lịch sử giao dịch</h2>
              <div class="card shadow-lg border-warning">
                <div class="card-body p-0">
                  <div class="table-responsive">
                    <table class="table table-hover mb-0">
                      <thead class="bg-warning bg-opacity-10">
                        <tr>
                          <th class="border-0 text-light">Họ và tên</th>
                          <th class="border-0 text-light">Số điện thoại</th>
                          <th class="border-0 text-light">Địa chỉ</th>
                          <th class="border-0 text-light">Thời gian đặt</th>
                          <th class="border-0 text-light">Ghi chú</th>
                          <th class="border-0 text-light">Chi tiết đơn hàng</th>
                          <th class="border-0 text-light">Trạng thái</th>
                        </tr>
                      </thead>
                      <tbody>
                        <% listOrders.forEach(function(order) { %>
                        <tr>
                          <td><%= order.customer_name %></td>
                          <td><%= order.customer_phone %></td>
                          <td class="text-wrap" style="max-width: 200px">
                            <%= order.address %>
                          </td>
                          <td class="text-muted">
                            <%= order.order_date %> <%= order.order_time %>
                          </td>
                          <td><%= order.notes %></td>
                          <td>
                            <button
                              class="btn btn-link p-0 text-primary"
                              data-bs-toggle="collapse"
                              data-bs-target="#orderDetails2"
                            >
                              <i class="fas fa-chevron-down me-1"></i>Xem chi
                              tiết
                            </button>
                            <div
                              id="orderDetails2"
                              class="collapse mt-2 bg-light p-3 rounded"
                            >
                              <p class="mb-1"></p>
                              <p class="mb-1">
                                <%= order.food_name %> <%= order.food_price %> x
                                <%= order.quantity %>
                              </p>
                              <p class="fw-bold mb-0">
                                Tổng: <%= order.total_price %>
                              </p>
                            </div>
                          </td>
                          <td>
                            <% if (order.status === 'Đã hủy') { %>
                            <span class="badge bg-danger rounded-pill px-3"
                              >Đã hủy</span
                            >
                            <% } else if (order.status === 'Đã vận chuyển') { %>
                            <span class="badge bg-success rounded-pill px-3"
                              >Đã vận chuyển</span
                            >
                            <% } else { %>
                            <span class="badge bg-warning rounded-pill px-3"
                              ><%= order.status %></span
                            >
                            <% } %>
                          </td>
                        </tr>
                        <% }) %>
                      </tbody>
                    </table>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </main>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="../public/vendors/is/is.min.js"></script>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=window.scroll"></script>
    <script src="../public/vendors/fontawesome/all.min.js"></script>
    <script src="../public/js/theme.js"></script>

    <link
      href="https://fonts.googleapis.com/css2?family=Source+Sans+Pro:wght@200;300;400;600;700;900&amp;display=swap"
      rel="stylesheet"
    />
  </body>
</html>
